"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("./index-C0i2q9jJ.cjs"),d=require("bitcoinjs-lib"),c=require("./BrowserWalletSigningError-pfMHrxFL.cjs"),u={mainnet:"livenet",testnet:"testnet"};function l(){if(typeof window>"u")throw new t.OrditSDKError("Cannot call this function outside a browser");return typeof window.unisat<"u"}async function g(o="mainnet",i){if(o==="signet")throw new t.OrditSDKError("signet network is not supported");if(!l())throw new t.BrowserWalletNotInstalledError("Unisat not installed");try{const e=await window.unisat.getNetwork(),r=u[o];e!==r&&await window.unisat.switchNetwork(r);const n=i?await window.unisat.getAccounts():await window.unisat.requestAccounts(),a=await window.unisat.getPublicKey(),s=n[0];if(!s)return[];const w=t.getAddressFormat(s,o);return[{publicKey:a,address:s,format:w}]}catch(e){if(e instanceof t.OrditSDKError)throw e;const r=e;throw(r==null?void 0:r.code)===4001?new t.BrowserWalletRequestCancelledByUserError:new t.OrditSDKError(r.message)}}async function f(o,{finalize:i=!0,extractTx:e=!0}={}){if(!l())throw new t.BrowserWalletNotInstalledError("Unisat not installed");if(e&&!i)throw new t.BrowserWalletExtractTxFromNonFinalizedPsbtError;const r=o.toHex();let n="";try{n=await window.unisat.signPsbt(r,{autoFinalized:i})}catch(s){const w=s;if((w==null?void 0:w.code)===4001)throw new t.BrowserWalletRequestCancelledByUserError}if(!n)throw new c.BrowserWalletSigningError("Failed to sign psbt hex using Unisat");const a=d.Psbt.fromHex(n);if(e)try{return{base64:null,hex:a.extractTransaction().toHex()}}catch(s){throw s instanceof Error&&s.message==="Not finalized"?new t.BrowserWalletExtractTxFromNonFinalizedPsbtError:new t.OrditSDKError("Failed to extract transaction from PSBT")}else return{base64:a.toBase64(),hex:a.toHex()}}async function h(o,i="ecdsa"){if(!l())throw new t.BrowserWalletNotInstalledError("Unisat not installed");let e="";try{e=await window.unisat.signMessage(o,i)}catch(r){const n=r;if((n==null?void 0:n.code)===4001)throw new t.BrowserWalletRequestCancelledByUserError}if(!e)throw new c.BrowserWalletSigningError("Failed to sign message using Unisat");return{base64:e,hex:t.Buffer.from(e,"base64").toString("hex")}}exports.getAddresses=g;exports.isInstalled=l;exports.signMessage=h;exports.signPsbt=f;
